<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Robot Tournament Calculator</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; }
    input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 18px;
      height: 18px;
      background: linear-gradient(135deg, #4fd1d9 0%, #a855f7 100%);
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 0 20px rgba(79, 209, 217, 0.5);
    }
    input[type="range"] {
      -webkit-appearance: none;
      appearance: none;
      background: #2a2a3e;
      border-radius: 3px;
    }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState } = React;

    const calculateTournament = (n) => {
      // For small fields (9-13), we want to minimize byes
      // Only give a bye to Q2W when mathematically necessary (odd number of robots)
      if (n >= 9 && n <= 13) {
        // Minimum byes: 1 if odd (to make Q1 even), 0 if even
        const q2wByeSeeds = n % 2 === 1 ? 1 : 0;
        
        // Robots fighting in Q1
        const q1Robots = n - q2wByeSeeds;
        const q1Byes = 0;
        const q1Fights = q1Robots / 2;
        const q1Winners = q1Fights;
        const q1Losers = q1Fights;
        
        // Q2W: bye seeds (at 1-0) + Q1 winners (at 1-0)
        const q2wRobots = q2wByeSeeds + q1Winners;
        const q2wByes = q2wRobots % 2;
        const q2wFights = Math.floor(q2wRobots / 2);
        const advanced2W = Math.ceil(q2wRobots / 2);
        const toQ3FromW = Math.floor(q2wRobots / 2);
        
        // Q2L: Q1 losers (at 0-1)
        const q2lRobots = q1Losers;
        const q2lByes = q2lRobots % 2;
        const q2lFights = Math.floor(q2lRobots / 2);
        const toQ3FromL = Math.ceil(q2lRobots / 2);
        const eliminated2L = Math.floor(q2lRobots / 2);
        
        // Q3: all 1-1 robots fight for last spots
        const q3Robots = toQ3FromW + toQ3FromL;
        const q3Byes = q3Robots % 2;
        const q3Fights = Math.floor(q3Robots / 2);
        const advancedQ3 = Math.ceil(q3Robots / 2);
        const eliminatedQ3 = Math.floor(q3Robots / 2);
        
        const totalAdvanced = advanced2W + advancedQ3;
        const totalEliminated = eliminated2L + eliminatedQ3;
        const totalFights = q1Fights + q2wFights + q2lFights + q3Fights;
        
        let bracketSize = 1;
        while (bracketSize * 2 <= totalAdvanced) {
          bracketSize *= 2;
        }
        
        const extraRobots = totalAdvanced - bracketSize;
        const playInRobots = extraRobots * 2;
        const playInMatches = extraRobots;
        const bracketByes = totalAdvanced - playInRobots;
        
        const bracketRounds = Math.log2(bracketSize);
        
        return {
          robotCount: n,
          isClean: false,
          nearestCleanDown: 8,
          nearestCleanUp: 16,
          isSmallField: true,
          q2wByeSeeds,
          q1Robots,
          q1Fights,
          q1Byes,
          q2wRobots,
          q2lRobots,
          q2wFights,
          q2wByes,
          advanced2W,
          toQ3FromW,
          q2lFights,
          q2lByes,
          toQ3FromL,
          eliminated2L,
          q3Robots,
          q3Fights,
          q3Byes,
          advancedQ3,
          eliminatedQ3,
          totalAdvanced,
          totalEliminated,
          totalFights,
          bracketSize,
          bracketByes,
          bracketRounds,
          playInRobots,
          playInMatches,
          totalTournamentFights: totalFights + (totalAdvanced - 1),
        };
      }
      
      return calculateWithByes(n, 0);
    };
    
    const calculateWithByes = (n, q2wByeSeeds) => {
      const q1Robots = n - q2wByeSeeds;
      const q1Byes = q1Robots % 2;
      const q1Fights = Math.floor(q1Robots / 2);
      const q2wFromQ1 = Math.ceil(q1Robots / 2);
      const q2lRobots = Math.floor(q1Robots / 2);

      const q2wRobots = q2wByeSeeds + q2wFromQ1;
      const q2wByes = q2wRobots % 2;
      const q2wFights = Math.floor(q2wRobots / 2);
      const advanced2W = Math.ceil(q2wRobots / 2);
      const toQ3FromW = Math.floor(q2wRobots / 2);

      const q2lByes = q2lRobots % 2;
      const q2lFights = Math.floor(q2lRobots / 2);
      const toQ3FromL = Math.ceil(q2lRobots / 2);
      const eliminated2L = Math.floor(q2lRobots / 2);

      const q3Robots = toQ3FromW + toQ3FromL;
      const q3Byes = q3Robots % 2;
      const q3Fights = Math.floor(q3Robots / 2);
      const advancedQ3 = Math.ceil(q3Robots / 2);
      const eliminatedQ3 = Math.floor(q3Robots / 2);

      const totalAdvanced = advanced2W + advancedQ3;
      const totalEliminated = eliminated2L + eliminatedQ3;
      const totalFights = q1Fights + q2wFights + q2lFights + q3Fights;

      let bracketSize = 1;
      while (bracketSize * 2 <= totalAdvanced) {
        bracketSize *= 2;
      }
      
      const extraRobots = totalAdvanced - bracketSize;
      const playInRobots = extraRobots * 2;
      const playInMatches = extraRobots;
      const bracketByes = totalAdvanced - playInRobots;
      
      const bracketRounds = Math.log2(bracketSize);

      const isClean = n % 4 === 0 && q2wByeSeeds === 0;
      const nearestCleanDown = Math.floor(n / 4) * 4;
      const nearestCleanUp = Math.ceil(n / 4) * 4;

      return {
        robotCount: n,
        isClean,
        nearestCleanDown,
        nearestCleanUp,
        isSmallField: false,
        q2wByeSeeds,
        q1Robots,
        q1Fights,
        q1Byes,
        q2wRobots,
        q2lRobots,
        q2wFights,
        q2wByes,
        advanced2W,
        toQ3FromW,
        q2lFights,
        q2lByes,
        toQ3FromL,
        eliminated2L,
        q3Robots,
        q3Fights,
        q3Byes,
        advancedQ3,
        eliminatedQ3,
        totalAdvanced,
        totalEliminated,
        totalFights,
        bracketSize,
        bracketByes,
        bracketRounds,
        playInRobots,
        playInMatches,
        totalTournamentFights: totalFights + (totalAdvanced - 1),
      };
    };

    const RoundCard = ({ title, icon, fights, byes, results, note }) => (
      <div style={{
        background: '#1e1e2e',
        borderRadius: '12px',
        padding: '18px',
        marginBottom: '12px',
      }}>
        <div style={{
          display: 'flex',
          alignItems: 'center',
          gap: '10px',
          marginBottom: '14px',
        }}>
          <span style={{ fontSize: '18px' }}>{icon}</span>
          <span style={{
            fontWeight: '600',
            fontSize: '15px',
            color: '#4fd1d9',
          }}>
            {title}
          </span>
          <div style={{
            marginLeft: 'auto',
            background: '#2a2a3e',
            padding: '4px 12px',
            borderRadius: '20px',
            fontSize: '13px',
            color: '#fff',
          }}>
            {fights} fights
            {byes > 0 && <span style={{ color: '#f0a500', marginLeft: '6px' }}>+{byes} bye</span>}
          </div>
        </div>
        {note && (
          <div style={{
            fontSize: '11px',
            color: '#a78bfa',
            marginBottom: '12px',
            padding: '8px 10px',
            background: 'rgba(168, 85, 247, 0.1)',
            borderRadius: '6px',
          }}>
            {note}
          </div>
        )}
        <div style={{ display: 'flex', gap: '12px', flexWrap: 'wrap' }}>
          {results.map((r, i) => (
            <div key={i} style={{
              display: 'flex',
              alignItems: 'center',
              gap: '6px',
              background: '#2a2a3e',
              padding: '6px 12px',
              borderRadius: '8px',
              fontSize: '13px',
            }}>
              <span style={{ color: r.color, fontWeight: 'bold' }}>{r.count}</span>
              <span style={{ color: '#8888a0' }}>{r.label}</span>
            </div>
          ))}
        </div>
      </div>
    );

    function TournamentCalculator() {
      const [robotCount, setRobotCount] = useState(16);
      const data = calculateTournament(robotCount);

      return (
        <div style={{
          minHeight: '100vh',
          background: '#0f0f1a',
          padding: '30px 20px',
          fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
          color: '#fff',
        }}>
          <div style={{
            maxWidth: '800px',
            margin: '0 auto',
          }}>
            {/* Header */}
            <div style={{
              display: 'flex',
              alignItems: 'center',
              gap: '14px',
              marginBottom: '32px',
            }}>
              <div style={{
                width: '48px',
                height: '48px',
                background: 'linear-gradient(135deg, #6366f1 0%, #a855f7 100%)',
                borderRadius: '12px',
                display: 'flex',
                alignItems: 'center',
                justifyContent: 'center',
                fontSize: '24px',
              }}>
                ü§ñ
              </div>
              <div>
                <h1 style={{
                  margin: 0,
                  fontSize: '24px',
                  fontWeight: '700',
                  fontStyle: 'italic',
                  background: 'linear-gradient(90deg, #4fd1d9 0%, #a855f7 100%)',
                  WebkitBackgroundClip: 'text',
                  WebkitTextFillColor: 'transparent',
                }}>
                  Tournament Calculator
                </h1>
                <div style={{ color: '#6b6b80', fontSize: '13px', marginTop: '2px' }}>
                  Double-elimination qualifiers ‚Üí Single-elimination bracket
                </div>
              </div>
            </div>

            {/* Input Section */}
            <div style={{
              background: '#1e1e2e',
              borderRadius: '12px',
              padding: '14px 20px',
              marginBottom: '16px',
              display: 'flex',
              alignItems: 'center',
              gap: '16px',
            }}>
              <span style={{ color: '#8888a0', fontSize: '13px', whiteSpace: 'nowrap' }}>Robots</span>
              <input
                type="range"
                min="9"
                max="80"
                value={robotCount}
                onChange={(e) => setRobotCount(parseInt(e.target.value))}
                style={{
                  flex: 1,
                  height: '6px',
                  cursor: 'pointer',
                }}
              />
              <div style={{
                fontSize: '28px',
                fontWeight: '700',
                color: '#4fd1d9',
                minWidth: '50px',
                textAlign: 'right',
              }}>
                {robotCount}
              </div>
            </div>
            
            {!data.isClean && !data.q2wByeSeeds && !data.isSmallField && (
              <div style={{
                marginBottom: '12px',
                padding: '10px 14px',
                background: 'rgba(240, 165, 0, 0.1)',
                border: '1px solid rgba(240, 165, 0, 0.3)',
                borderRadius: '8px',
                fontSize: '12px',
                color: '#f0a500',
                display: 'flex',
                alignItems: 'center',
                gap: '8px',
              }}>
                <span>‚ö†Ô∏è</span>
                <span>Prelim byes needed. Clean numbers: <strong>{data.nearestCleanDown}</strong> or <strong>{data.nearestCleanUp}</strong></span>
              </div>
            )}
            
            {data.isSmallField && (
              <div style={{
                marginBottom: '12px',
                padding: '12px 14px',
                background: 'rgba(168, 85, 247, 0.15)',
                border: '1px solid rgba(168, 85, 247, 0.4)',
                borderRadius: '8px',
                fontSize: '12px',
                color: '#c084fc',
              }}>
                <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '6px' }}>
                  <span>üéüÔ∏è</span>
                  <strong>Small Field ({data.robotCount} robots)</strong>
                </div>
                <div style={{ color: '#a78bfa', lineHeight: '1.5' }}>
                  {data.q2wByeSeeds > 0 ? (
                    <span>‚Ä¢ #1 prelim seed gets bye to Q2W (odd field)<br/></span>
                  ) : null}
                  ‚Ä¢ {data.q1Robots} robots fight in Q1<br/>
                  ‚Ä¢ {data.totalAdvanced} qualify for bracket
                </div>
              </div>
            )}
            
            {data.q2wByeSeeds > 0 && !data.isSmallField && (
              <div style={{
                marginBottom: '12px',
                padding: '10px 14px',
                background: 'rgba(168, 85, 247, 0.15)',
                border: '1px solid rgba(168, 85, 247, 0.4)',
                borderRadius: '8px',
                fontSize: '12px',
                color: '#c084fc',
                display: 'flex',
                alignItems: 'center',
                gap: '8px',
              }}>
                <span>üéüÔ∏è</span>
                <span><strong>{data.q2wByeSeeds} Q2W bye{data.q2wByeSeeds > 1 ? 's' : ''}</strong> ‚Äî top seed{data.q2wByeSeeds > 1 ? 's' : ''} skip Q1 and enter Q2W at 1-0</span>
              </div>
            )}

            {/* Section Header */}
            <div style={{
              display: 'flex',
              alignItems: 'center',
              gap: '10px',
              marginBottom: '16px',
            }}>
              <span style={{ fontSize: '18px' }}>‚öîÔ∏è</span>
              <span style={{
                color: '#4fd1d9',
                fontWeight: '600',
                fontSize: '18px',
              }}>
                Qualifying Rounds
              </span>
            </div>

            {/* Qualifier Rounds */}
            <RoundCard
              title={data.q2wByeSeeds > 0 ? `Q1 ‚Äî ${data.q1Robots} Robots Fight` : "Q1 ‚Äî All Robots Fight"}
              icon="üéØ"
              fights={data.q1Fights}
              byes={data.q1Byes}
              note={data.isSmallField && data.q2wByeSeeds > 0 ? `#1 prelim seed gets bye to Q2W` : null}
              results={[
                { count: data.q2wRobots - (data.q2wByeSeeds || 0), label: '‚Üí Q2W (1-0)', color: '#4fd1d9' },
                { count: data.q2lRobots, label: '‚Üí Q2L (0-1)', color: '#8888a0' },
              ]}
            />

            <div style={{ display: 'grid', gridTemplateColumns: '1fr 1fr', gap: '12px' }}>
              <RoundCard
                title={data.q2wByeSeeds > 0 ? `Q2W ‚Äî ${data.q2wByeSeeds} Bye + Winners` : "Q2W ‚Äî Winners"}
                icon="üèÜ"
                fights={data.q2wFights}
                byes={data.q2wByes}
                results={[
                  { count: data.advanced2W, label: '‚úì Qualify (2-0)', color: '#22c55e' },
                  { count: data.toQ3FromW, label: '‚Üí Q3 (1-1)', color: '#8888a0' },
                ]}
              />
              <RoundCard
                title="Q2L ‚Äî Losers"
                icon="üíÄ"
                fights={data.q2lFights}
                byes={data.q2lByes}
                results={[
                  { count: data.toQ3FromL, label: '‚Üí Q3 (1-1)', color: '#8888a0' },
                  { count: data.eliminated2L, label: '‚úó Out (0-2)', color: '#ef4444' },
                ]}
              />
            </div>

            <RoundCard
              title="Q3 ‚Äî Last Chance"
              icon="‚ö°"
              fights={data.q3Fights}
              byes={data.q3Byes}
              results={[
                { count: data.advancedQ3, label: '‚úì Qualify (2-1)', color: '#22c55e' },
                { count: data.eliminatedQ3, label: '‚úó Out (1-2)', color: '#ef4444' },
              ]}
            />

            {/* Gradient Divider */}
            <div style={{
              height: '3px',
              background: 'linear-gradient(90deg, #4fd1d9 0%, #a855f7 50%, #ec4899 100%)',
              borderRadius: '2px',
              margin: '24px 0',
            }} />

            {/* Stats Row */}
            <div style={{
              display: 'grid',
              gridTemplateColumns: (data.q2wByeSeeds > 0 || data.isSmallField) ? 'repeat(4, 1fr)' : 'repeat(3, 1fr)',
              gap: '12px',
              marginBottom: '24px',
            }}>
              {[
                { label: 'Qualifier Fights', value: data.totalFights, color: '#4fd1d9' },
                { label: 'Qualify', value: data.totalAdvanced, color: '#22c55e' },
                ...((data.q2wByeSeeds > 0 || data.isSmallField) ? [{ label: 'Q2W Byes', value: data.q2wByeSeeds, color: '#c084fc' }] : []),
                { label: 'Eliminated', value: data.totalEliminated, color: '#ef4444' },
              ].map((stat, i) => (
                <div key={i} style={{
                  background: '#1e1e2e',
                  borderRadius: '12px',
                  padding: '16px',
                  textAlign: 'center',
                }}>
                  <div style={{
                    fontSize: '28px',
                    fontWeight: '700',
                    color: stat.color,
                  }}>
                    {stat.value}
                  </div>
                  <div style={{
                    fontSize: '12px',
                    color: '#6b6b80',
                    marginTop: '4px',
                  }}>
                    {stat.label}
                  </div>
                </div>
              ))}
            </div>

            {/* Bracket Section */}
            <div style={{
              display: 'flex',
              alignItems: 'center',
              gap: '10px',
              marginBottom: '16px',
            }}>
              <span style={{ fontSize: '18px' }}>üèÖ</span>
              <span style={{
                color: '#ec4899',
                fontWeight: '600',
                fontSize: '18px',
              }}>
                Single Elimination Bracket
              </span>
            </div>

            {/* Bracket Info */}
            <div style={{
              background: '#1e1e2e',
              borderRadius: '16px',
              padding: '20px',
              marginBottom: '24px',
            }}>
              <div style={{
                display: 'flex',
                alignItems: 'baseline',
                gap: '12px',
                marginBottom: '16px',
              }}>
                <div style={{
                  fontSize: '36px',
                  fontWeight: '700',
                  background: 'linear-gradient(135deg, #4fd1d9 0%, #a855f7 100%)',
                  WebkitBackgroundClip: 'text',
                  WebkitTextFillColor: 'transparent',
                }}>
                  {data.totalAdvanced}
                </div>
                <div style={{ color: '#6b6b80', fontSize: '14px' }}>
                  robots enter bracket
                </div>
              </div>

              {data.playInMatches > 0 ? (
                <div style={{
                  background: '#2a2a3e',
                  borderRadius: '10px',
                  padding: '14px',
                  marginBottom: '14px',
                }}>
                  <div style={{ fontSize: '12px', color: '#8888a0', marginBottom: '10px', textTransform: 'uppercase', letterSpacing: '0.5px' }}>
                    Play-in Round
                  </div>
                  <div style={{ display: 'flex', gap: '20px', flexWrap: 'wrap', fontSize: '13px' }}>
                    <div><span style={{ color: '#4fd1d9', fontWeight: '600' }}>{data.playInRobots}</span> <span style={{ color: '#6b6b80' }}>robots fight</span></div>
                    <div><span style={{ color: '#f0a500', fontWeight: '600' }}>{data.playInMatches}</span> <span style={{ color: '#6b6b80' }}>matches</span></div>
                    <div><span style={{ color: '#22c55e', fontWeight: '600' }}>{data.bracketByes}</span> <span style={{ color: '#6b6b80' }}>play-in byes</span></div>
                  </div>
                  <div style={{
                    marginTop: '10px',
                    fontSize: '11px',
                    color: '#22c55e',
                  }}>
                    üí° Play-in byes go to top seeds (2-0 qualifiers prioritized)
                  </div>
                </div>
              ) : (
                <div style={{
                  background: 'rgba(34, 197, 94, 0.1)',
                  borderRadius: '10px',
                  padding: '12px 14px',
                  marginBottom: '14px',
                  fontSize: '13px',
                  color: '#22c55e',
                }}>
                  ‚úì Perfect fit ‚Äî no play-in round needed, straight to {data.bracketSize}-bot bracket!
                </div>
              )}

              <div style={{
                background: '#2a2a3e',
                borderRadius: '10px',
                padding: '14px',
              }}>
                <div style={{ fontSize: '12px', color: '#8888a0', marginBottom: '10px', textTransform: 'uppercase', letterSpacing: '0.5px' }}>
                  {data.playInMatches > 0 ? `Round 2+ ‚Äî Main ${data.bracketSize}-Bot Bracket` : `Main ${data.bracketSize}-Bot Bracket`}
                </div>
                <div style={{ display: 'flex', gap: '20px', flexWrap: 'wrap', fontSize: '13px' }}>
                  <div><span style={{ color: '#fff', fontWeight: '600' }}>{data.bracketSize}</span> <span style={{ color: '#6b6b80' }}>robots</span></div>
                  <div><span style={{ color: '#fff', fontWeight: '600' }}>{data.bracketRounds}</span> <span style={{ color: '#6b6b80' }}>rounds</span></div>
                  <div><span style={{ color: '#fff', fontWeight: '600' }}>{data.bracketSize - 1}</span> <span style={{ color: '#6b6b80' }}>fights</span></div>
                </div>
              </div>

              {/* Totals */}
              <div style={{
                display: 'flex',
                justifyContent: 'space-around',
                marginTop: '16px',
                padding: '14px',
                background: '#0f0f1a',
                borderRadius: '10px',
              }}>
                <div style={{ textAlign: 'center' }}>
                  <div style={{ color: '#fff', fontWeight: '600', fontSize: '18px' }}>{data.playInMatches > 0 ? data.bracketRounds + 1 : data.bracketRounds}</div>
                  <div style={{ color: '#6b6b80', fontSize: '11px', marginTop: '2px' }}>TOTAL ROUNDS</div>
                </div>
                <div style={{ textAlign: 'center' }}>
                  <div style={{ color: '#fff', fontWeight: '600', fontSize: '18px' }}>{data.totalAdvanced - 1}</div>
                  <div style={{ color: '#6b6b80', fontSize: '11px', marginTop: '2px' }}>BRACKET FIGHTS</div>
                </div>
                <div style={{ textAlign: 'center' }}>
                  <div style={{
                    fontWeight: '600',
                    fontSize: '18px',
                    background: 'linear-gradient(90deg, #4fd1d9 0%, #ec4899 100%)',
                    WebkitBackgroundClip: 'text',
                    WebkitTextFillColor: 'transparent',
                  }}>{data.totalTournamentFights}</div>
                  <div style={{ color: '#6b6b80', fontSize: '11px', marginTop: '2px' }}>TOTAL FIGHTS</div>
                </div>
              </div>
            </div>

            {/* Round Names */}
            <div style={{
              background: '#1e1e2e',
              borderRadius: '12px',
              padding: '18px',
            }}>
              <div style={{
                color: '#6b6b80',
                fontSize: '12px',
                marginBottom: '12px',
                letterSpacing: '0.5px',
              }}>
                BRACKET ROUNDS
              </div>
              <div style={{
                display: 'flex',
                flexWrap: 'wrap',
                gap: '8px',
              }}>
                {data.bracketRounds >= 7 && (
                  <span style={{ background: '#2a2a3e', padding: '6px 12px', borderRadius: '6px', fontSize: '13px' }}>
                    Round of {data.bracketSize}
                  </span>
                )}
                {data.bracketRounds >= 6 && (
                  <span style={{ background: '#2a2a3e', padding: '6px 12px', borderRadius: '6px', fontSize: '13px' }}>
                    Round of 64
                  </span>
                )}
                {data.bracketRounds >= 5 && (
                  <span style={{ background: '#2a2a3e', padding: '6px 12px', borderRadius: '6px', fontSize: '13px' }}>
                    Round of 32
                  </span>
                )}
                {data.bracketRounds >= 4 && (
                  <span style={{ background: '#2a2a3e', padding: '6px 12px', borderRadius: '6px', fontSize: '13px' }}>
                    Round of 16
                  </span>
                )}
                {data.bracketRounds >= 3 && (
                  <span style={{ background: '#2a2a3e', padding: '6px 12px', borderRadius: '6px', fontSize: '13px' }}>
                    Quarterfinals
                  </span>
                )}
                {data.bracketRounds >= 2 && (
                  <span style={{ background: '#2a2a3e', padding: '6px 12px', borderRadius: '6px', fontSize: '13px' }}>
                    Semifinals
                  </span>
                )}
                <span style={{
                  background: 'linear-gradient(135deg, #4fd1d9 0%, #ec4899 100%)',
                  padding: '6px 12px',
                  borderRadius: '6px',
                  fontSize: '13px',
                  fontWeight: '600',
                }}>
                  üèÜ Finals
                </span>
              </div>
            </div>

            {/* Bracket Preview */}
            <div style={{
              marginTop: '24px',
              display: 'flex',
              alignItems: 'center',
              gap: '10px',
              marginBottom: '16px',
            }}>
              <span style={{ fontSize: '18px' }}>üìä</span>
              <span style={{
                color: '#4fd1d9',
                fontWeight: '600',
                fontSize: '18px',
              }}>
                Bracket Preview
              </span>
            </div>

            <div style={{
              background: '#1e1e2e',
              borderRadius: '16px',
              padding: '20px',
              overflowX: 'auto',
            }}>
              {/* Seeding Legend */}
              <div style={{
                display: 'flex',
                gap: '16px',
                marginBottom: '20px',
                fontSize: '12px',
                flexWrap: 'wrap',
              }}>
                <div style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>
                  <div style={{ width: '12px', height: '12px', background: '#22c55e', borderRadius: '3px' }} />
                  <span style={{ color: '#8888a0' }}>Play-in bye (direct to bracket)</span>
                </div>
                <div style={{ display: 'flex', alignItems: 'center', gap: '6px' }}>
                  <div style={{ width: '12px', height: '12px', background: '#f0a500', borderRadius: '3px' }} />
                  <span style={{ color: '#8888a0' }}>Play-in winner</span>
                </div>
              </div>

              {/* Bracket Visualization */}
              <div style={{
                display: 'flex',
                gap: '12px',
                alignItems: 'center',
                minWidth: 'fit-content',
              }}>
                {/* Play-in Round */}
                {data.playInMatches > 0 && (
                  <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>
                    <div style={{
                      fontSize: '10px',
                      color: '#6b6b80',
                      textTransform: 'uppercase',
                      letterSpacing: '0.5px',
                      marginBottom: '4px',
                      textAlign: 'center',
                    }}>
                      Play-ins <span style={{ color: '#4fd1d9' }}>({data.playInRobots})</span>
                    </div>
                    {Array.from({ length: data.playInMatches }).map((_, i) => {
                      const playInStartSeed = data.bracketByes + 1;
                      const playInEndSeed = data.totalAdvanced;
                      const highSeed = playInStartSeed + i;
                      const lowSeed = playInEndSeed - i;
                      
                      return (
                        <div key={i} style={{
                          background: '#2a2a3e',
                          borderRadius: '6px',
                          padding: '8px 10px',
                          fontSize: '11px',
                        }}>
                          <div style={{ color: '#f0a500', fontSize: '9px', marginBottom: '4px', fontWeight: '600' }}>
                            Play-in {i + 1}
                          </div>
                          <div style={{ color: '#4fd1d9' }}>#{highSeed} vs #{lowSeed}</div>
                        </div>
                      );
                    })}
                  </div>
                )}

                {/* Arrow and connectors from play-ins */}
                {data.playInMatches > 0 && (
                  <svg style={{ 
                    width: '30px',
                    minHeight: `${data.playInMatches * 58 + 24}px`,
                    marginTop: '24px',
                  }}>
                    {Array.from({ length: data.playInMatches }).map((_, i) => {
                      const fightHeight = 58;
                      const y = i * fightHeight + fightHeight * 0.5;
                      return (
                        <line key={i} x1="0" y1={y} x2="30" y2={y} stroke="#4a4a5a" strokeWidth="1" />
                      );
                    })}
                  </svg>
                )}

                {/* Main Bracket Rounds */}
                {Array.from({ length: data.bracketRounds }).map((_, roundIndex) => {
                  const matchesInRound = data.bracketSize / Math.pow(2, roundIndex + 1);
                  const robotsInRound = matchesInRound * 2;
                  const roundName = roundIndex === data.bracketRounds - 1 ? 'Finals' :
                                   roundIndex === data.bracketRounds - 2 ? 'Semis' :
                                   roundIndex === data.bracketRounds - 3 ? 'Quarters' :
                                   `R${roundIndex + 1}`;
                  
                  const fightHeight = 78;
                  
                  return (
                    <React.Fragment key={roundIndex}>
                      <div style={{ display: 'flex', flexDirection: 'column', gap: '8px' }}>
                        <div style={{
                          fontSize: '10px',
                          color: '#6b6b80',
                          textTransform: 'uppercase',
                          letterSpacing: '0.5px',
                          marginBottom: '4px',
                          textAlign: 'center',
                        }}>
                          {roundName} <span style={{ color: '#4fd1d9' }}>({robotsInRound})</span>
                        </div>
                        {(() => {
                          // Calculate matchups once for this bracket size
                          const n = data.bracketSize;
                          const halfN = n / 2;
                          
                          // Generate standard bracket matchups
                          // For 8: 1v8, 4v5, 3v6, 2v7 (A-B-C-D quadrant order)
                          const getStandardMatchups = (size) => {
                            if (size === 2) return [[1, 2]];
                            if (size === 4) return [[1, 4], [2, 3]];
                            
                            const result = [];
                            const half = size / 2;
                            const prevMatchups = getStandardMatchups(half);
                            
                            for (let i = 0; i < prevMatchups.length; i++) {
                              const [a, b] = prevMatchups[i];
                              result.push([Math.min(a,b), size + 1 - Math.min(a,b)]);
                              result.push([Math.max(a,b), size + 1 - Math.max(a,b)]);
                            }
                            
                            // Swap matches 3 and 4 (indices 2 and 3) for size 8
                            if (size === 8) {
                              [result[2], result[3]] = [result[3], result[2]];
                            }
                            
                            return result;
                          };
                          
                          let matchups = getStandardMatchups(n);
                          
                          // Apply seed swap to bottom-half seeds
                          matchups = matchups.map(m => {
                            const bottomSeed = m[1];
                            if (bottomSeed > halfN) {
                              const offset = bottomSeed - halfN - 1;
                              const pairIndex = Math.floor(offset / 2);
                              const posInPair = offset % 2;
                              const swappedSeed = halfN + 1 + (pairIndex * 2) + (1 - posInPair);
                              return [m[0], swappedSeed];
                            }
                            return m;
                          });
                          
                          return Array.from({ length: matchesInRound }).map((_, matchIndex) => {
                            // For first round, show seed numbers with correct matchups
                            // Figure out play-in to R1 mapping
                            const getPlayInNumber = (seed) => {
                              if (data.playInMatches === 0) return null;
                              if (seed <= data.bracketByes) return null;
                              const playInStartSeed = data.bracketByes + 1;
                              if (seed >= playInStartSeed && seed <= playInStartSeed + data.playInMatches - 1) {
                                return seed - playInStartSeed + 1;
                              }
                              return null;
                            };
                            
                            const fightNum = matchIndex + 1;
                            
                            if (roundIndex === 0) {
                              const matchup = matchups[matchIndex];
                              const seed1 = matchup[0];
                              const seed2 = matchup[1];
                              
                              const hasBye1 = data.playInMatches > 0 && seed1 <= data.bracketByes;
                              const hasBye2 = data.playInMatches > 0 && seed2 <= data.bracketByes;
                              const playIn1 = getPlayInNumber(seed1);
                              const playIn2 = getPlayInNumber(seed2);
                              
                              const formatSeed = (seed, hasBye, playInNum) => {
                                if (hasBye) return `#${seed}`;
                                if (playInNum) return `W Play-in ${playInNum}`;
                                return `#${seed}`;
                              };
                            
                              return (
                                <div key={matchIndex} style={{
                                  background: '#2a2a3e',
                                  borderRadius: '6px',
                                  padding: '8px 10px',
                                  fontSize: '11px',
                                  minWidth: '120px',
                                }}>
                                  <div style={{ color: '#4fd1d9', fontSize: '9px', marginBottom: '4px', fontWeight: '600' }}>
                                    {roundName} Fight {fightNum}
                                  </div>
                                  <div style={{ color: hasBye1 ? '#22c55e' : '#f0a500' }}>
                                    {formatSeed(seed1, hasBye1, playIn1)}
                                  </div>
                                  <div style={{ color: '#6b6b80', fontSize: '9px' }}>vs</div>
                                  <div style={{ color: hasBye2 ? '#22c55e' : '#f0a500' }}>
                                    {formatSeed(seed2, hasBye2, playIn2)}
                                  </div>
                                </div>
                              );
                            }
                          
                            // Later rounds - show fight references
                            const getFirstRoundFights = (round, match) => {
                              if (round === 0) return [match + 1];
                              const fight1 = getFirstRoundFights(round - 1, match * 2);
                              const fight2 = getFirstRoundFights(round - 1, match * 2 + 1);
                              return [...fight1, ...fight2];
                            };
                            
                            const feedingFights = getFirstRoundFights(roundIndex, matchIndex);
                            const halfPoint = feedingFights.length / 2;
                            const topFights = feedingFights.slice(0, halfPoint);
                            const bottomFights = feedingFights.slice(halfPoint);
                            
                            const formatFightRef = (fights) => {
                              if (fights.length === 1) return `W R1-${fights[0]}`;
                              return `W R1-(${fights.join(',')})`;
                            };
                          
                            return (
                              <div key={matchIndex} style={{
                                background: '#2a2a3e',
                                borderRadius: '6px',
                                padding: '8px 10px',
                                fontSize: '10px',
                                minWidth: '100px',
                              }}>
                                <div style={{ color: '#a78bfa', fontSize: '9px', marginBottom: '4px', fontWeight: '600' }}>
                                  {roundName} Fight {fightNum}
                                </div>
                                <div style={{ color: '#8888a0' }}>{formatFightRef(topFights)}</div>
                                <div style={{ color: '#6b6b80', fontSize: '9px' }}>vs</div>
                                <div style={{ color: '#8888a0' }}>{formatFightRef(bottomFights)}</div>
                              </div>
                            );
                          });
                        })()}
                      </div>
                      {/* Connector lines to next round */}
                      {roundIndex < data.bracketRounds - 1 && (
                        <svg style={{ 
                          width: '30px',
                          minHeight: `${matchesInRound * 78 + 24}px`,
                          marginTop: '24px',
                        }}>
                          {Array.from({ length: matchesInRound / 2 }).map((_, pairIndex) => {
                            const baseOffset = pairIndex * fightHeight * 2;
                            const y1 = baseOffset + fightHeight * 0.5;
                            const y2 = baseOffset + fightHeight * 1.5;
                            const midY = (y1 + y2) / 2;
                            
                            return (
                              <g key={pairIndex}>
                                <line x1="0" y1={y1} x2="15" y2={y1} stroke="#4a4a5a" strokeWidth="1" />
                                <line x1="0" y1={y2} x2="15" y2={y2} stroke="#4a4a5a" strokeWidth="1" />
                                <line x1="15" y1={y1} x2="15" y2={y2} stroke="#4a4a5a" strokeWidth="1" />
                                <line x1="15" y1={midY} x2="30" y2={midY} stroke="#4a4a5a" strokeWidth="1" />
                              </g>
                            );
                          })}
                        </svg>
                      )}
                    </React.Fragment>
                  );
                })}

                {/* Trophy */}
                <div style={{
                  display: 'flex',
                  flexDirection: 'column',
                  alignItems: 'center',
                  gap: '8px',
                  marginLeft: '8px',
                }}>
                  <div style={{ fontSize: '32px' }}>üèÜ</div>
                  <div style={{
                    fontSize: '10px',
                    color: '#ec4899',
                    fontWeight: '600',
                    textTransform: 'uppercase',
                  }}>
                    Champion
                  </div>
                </div>
              </div>

              {/* Bracket Seeding Explanation */}
              <div style={{
                marginTop: '20px',
                padding: '12px',
                background: '#0f0f1a',
                borderRadius: '8px',
                fontSize: '12px',
                color: '#8888a0',
                lineHeight: '1.6',
              }}>
                <div style={{ marginBottom: '8px' }}>
                  <strong style={{ color: '#4fd1d9' }}>Prelim Seed:</strong> Ranking coming into the event, used for prelim matchups.
                </div>
                <div style={{ marginBottom: '8px' }}>
                  <strong style={{ color: '#22c55e' }}>Bracket Seed:</strong> Reseeded after prelims based on performance. 2-0 qualifiers get bracket seeds 1-{data.advanced2W}, 2-1 qualifiers get bracket seeds {data.advanced2W + 1}-{data.totalAdvanced}. 
                  If a top prelim seed loses, whoever beat them (and went 2-0) takes their bracket seed.
                </div>
                <div style={{ marginBottom: '8px' }}>
                  <strong style={{ color: '#a78bfa' }}>Bottom-half swap:</strong> Bracket seeds {Math.floor(data.bracketSize/2) + 1}-{data.bracketSize} are swapped in pairs 
                  ({Math.floor(data.bracketSize/2) + 1}‚Üî{Math.floor(data.bracketSize/2) + 2}, {Math.floor(data.bracketSize/2) + 3}‚Üî{Math.floor(data.bracketSize/2) + 4}, etc.)
                </div>
                {data.playInMatches > 0 && (
                  <div>
                    <strong style={{ color: '#f0a500' }}>Play-in byes:</strong> Bracket seeds 1-{data.bracketByes} skip play-ins and go straight to bracket.
                  </div>
                )}
              </div>
            </div>
          </div>
        </div>
      );
    }

    ReactDOM.render(<TournamentCalculator />, document.getElementById('root'));
  </script>
</body>
</html>
